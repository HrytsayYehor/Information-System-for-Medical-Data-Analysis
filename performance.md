
# Performance Profiling Report

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è

–î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ Python-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É, –ø–æ–±—É–¥–æ–≤–∞–Ω–æ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–æ–¥–µ–ª—ñ GPT-Neo —Ç–∞ –ø–æ—à—É–∫–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ FAISS, –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –º–æ–¥—É–ª—å `memory_profiler` –¥–ª—è –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ, –∞ —Ç–∞–∫–æ–∂ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –∑–±–æ—Ä—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π.

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è:

- `memory_profiler`: –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ—ó –ø–∞–º'—è—Ç—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É.
- `cProfile`: –¥–ª—è –∑–±–æ—Ä—É –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π.
- FAISS (`faiss.IndexFlatL2`): –¥–ª—è —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—ó –µ–º–±–µ–¥—ñ–Ω–≥—ñ–≤ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞ —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É –ø–æ–¥—ñ–±–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤.

## –ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ (Memory Usage)
- –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π (Execution Time)
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–∫–ª–∏–∫—ñ–≤ —Ñ—É–Ω–∫—Ü—ñ–π (Function Calls)
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —É FAISS

## –¢–µ—Å—Ç–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

–ë—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —Å—Ü–µ–Ω–∞—Ä—ñ–π, —è–∫–∏–π:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –ª–æ–∫–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å GPT-Neo –∑ HuggingFace (`AutoModelForCausalLM`).
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ç–æ–∫–µ–Ω—ñ–∑–∞—Ç–æ—Ä (`AutoTokenizer`).
3. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—î –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é —É –≤–µ–∫—Ç–æ—Ä–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SentenceTransformer.
4. –Ü–Ω–¥–µ–∫—Å—É—î –¥–æ–∫—É–º–µ–Ω—Ç–∏ —É FAISS.
5. –ü—Ä–æ–≤–æ–¥–∏—Ç—å –ø–æ—à—É–∫ –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –≤–µ–∫—Ç–æ—Ä—ñ–≤.

## –ü—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è –∫–æ–¥—É

### –§—Ä–∞–≥–º–µ–Ω—Ç 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ

```python
@profile
def load_local_model(model_name):
    print("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–æ–¥–µ–ª—ñ...")
    tokenizer = AutoTokenizer.from_pretrained(model_name)
    if tokenizer.pad_token is None:
        tokenizer.pad_token = tokenizer.eos_token
    model = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype="auto")
    return model, tokenizer
```

üïí –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: ~2.12 —Å (–æ—Å–Ω–æ–≤–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∞–≥ –º–æ–¥–µ–ª—ñ)
üíæ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ: –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –¥–æ ~492 MiB

### –§—Ä–∞–≥–º–µ–Ω—Ç 2: –Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—è FAISS

```python
@profile
def initialize_faiss(documents, _embedding_model):
    print("–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è FAISS...")
    document_embeddings = _embedding_model.encode(
        documents, show_progress_bar=True, normalize_embeddings=True
    )
    dimension = document_embeddings.shape[1]
    index = faiss.IndexFlatL2(dimension)
    index.add(np.array(document_embeddings, dtype=np.float32))
    return index, document_embeddings
```

üïí –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: ~0.7 —Å –Ω–∞ –µ–º–±–µ–¥—ñ–Ω–≥ 4 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
üíæ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ: ~66.7 MiB

## –ó—ñ–±—Ä–∞–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏

| –û–ø–µ—Ä–∞—Ü—ñ—è                      | –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ |
|------------------------------|---------------|------------------------|
| –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ          | ~2.12 —Å       | ~492 MiB               |
| –¢–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—è + FAISS —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è | ~0.7 —Å      | ~66.7 MiB              |
| –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤      | <0.3 —Å        | ~10-20 MiB             |

## –í–∏—è–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é

1. ‚ö†Ô∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –∑–∞–π–º–∞—î –Ω–∞–π–±—ñ–ª—å—à–µ —á–∞—Å—É —Ç–∞ –ø–∞–º‚Äô—è—Ç—ñ. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è ‚Äî –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –º–æ–¥–µ–ª—å –ª–æ–∫–∞–ª—å–Ω–æ —É —Å—Ç–∏—Å–Ω—É—Ç–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ–Ω—à—ñ –º–æ–¥–µ–ª—ñ, —è–∫—â–æ —Ü–µ –¥–æ–ø—É—Å—Ç–∏–º–æ.
2. ‚ö†Ô∏è –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ SentenceTransformer —î —Ä–µ—Å—É—Ä—Å–æ—î–º–Ω–æ—é. –ú–æ–∂–Ω–∞ –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –∞–±–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤.
3. ‚ö†Ô∏è –í—ñ–¥—Å—É—Ç–Ω—ñ–π –º–µ—Ö–∞–Ω—ñ–∑–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—ó (–∫–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ FAISS). –Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É.

## –í–∏—Å–Ω–æ–≤–∫–∏

–ë–∞–∑–æ–≤–µ –ø—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è –≤–∏—è–≤–∏–ª–æ –∫—ñ–ª—å–∫–∞ –∫–ª—é—á–æ–≤–∏—Ö "–≥–∞—Ä—è—á–∏—Ö —Ç–æ—á–æ–∫", –ø–æ–≤'—è–∑–∞–Ω–∏—Ö —ñ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –º–æ–¥–µ–ª—ñ —Ç–∞ –µ–º–±–µ–¥—ñ–Ω–≥–æ–º –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤. –ü–æ–¥–∞–ª—å—à–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –º–æ–∂–µ –≤–∫–ª—é—á–∞—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É FAISS, –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –µ–º–±–µ–¥—ñ–Ω–≥–∏, –∞ —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ–Ω—à–æ—ó –º–æ–¥–µ–ª—ñ –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è —á–∞—Å—É —Ä–µ–∞–∫—Ü—ñ—ó –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É.
